# Design Document: ุชุญุณูู ุฅุฏุงุฑุฉ ุงูุณูุงู

**ุงููุดุฑูุน:** ุจุตูุฑ MVP  
**ุงูุชุงุฑูุฎ:** 7 ุฏูุณูุจุฑ 2025  
**ุงููุคูู:** ูุฑูู ูููุงุก ุชุทููุฑ ูุดุฑูุน ุจุตูุฑ  
**ุงูุญุงูุฉ:** ๐ ููุฏ ุงููุฑุงุฌุนุฉ

---

## Overview

ูุฐุง ุงูุชุตููู ููุฏู ุญูููุงู ุดุงููุฉ ููุดููุฉ ุชุฌุงูุฒ ุญุฏ ุงูุณูุงู ูู ุฎูุงู ุฅุนุงุฏุฉ ููููุฉ ูููุงุช ุงูุชูุฌูู ูุชุญุณูู ุฅุฏุงุฑุฉ ุงููุนูููุงุช.

---

## Architecture

### ุงูุจููุฉ ุงููุฑููุฉ ุงูุฌุฏูุฏุฉ

```
.kiro/steering/
โโโ core/                    # ุงููููุงุช ุงูุฃุณุงุณูุฉ (ุชูุญููู ุฏุงุฆูุงู)
โ   โโโ philosophy.md       # ุงููุจุงุฏุฆ ุงูุฃุณุงุณูุฉ (ูุฎุชุตุฑ)
โ   โโโ quick-reference.md  # ูุฑุฌุน ุณุฑูุน ูููุนุงููุฑ
โ   โโโ team-identity.md    # ูููุฉ ุงููุฑูู
โ
โโโ standards/              # ุงููุนุงููุฑ (ุชูุญููู ุนูุฏ ุงูุญุงุฌุฉ)
โ   โโโ naming.md
โ   โโโ code-quality.md
โ   โโโ testing.md
โ   โโโ documentation.md
โ
โโโ guides/                 # ุงูุฃุฏูุฉ ุงูุชูุตูููุฉ (ูุฑุฌุนูุฉ)
โ   โโโ flutter-guide.md
โ   โโโ git-guide.md
โ   โโโ security-guide.md
โ   โโโ arabic-guide.md
โ
โโโ reference/              # ุงููุฑุงุฌุน ุงููุงููุฉ (ุนูุฏ ุงูุทูุจ ููุท)
    โโโ full-standards.md
    โโโ examples.md
    โโโ best-practices.md
```

---

## Components and Interfaces

### 1. Core Files (ุงููููุงุช ุงูุฃุณุงุณูุฉ)

#### philosophy.md (ูุฎุชุตุฑ)

```markdown
# ุงูููุณูุฉ ุงูููุฏุณูุฉ

## ุงููุจุงุฏุฆ ุงูุฃุณุงุณูุฉ

1. **ุงูุฃูุงู ุฃููุงู** - ูุง ุชูุงุฒู ุนู ุงูุฃูุงู
2. **Spec-Driven** - ูู ุนูู ูุจุฏุฃ ุจููุงุตูุฉ
3. **ุงูุฌูุฏุฉ ูุจู ุงูุณุฑุนุฉ** - ููุฏ ูุธูู ููุฎุชุจุฑ
4. **ุงููููุฉ ุงูููุญุฏุฉ** - "ูุฑูู ูููุงุก ุชุทููุฑ ูุดุฑูุน ุจุตูุฑ"

## ุงูููุงุนุฏ ุงูุฃุณุงุณูุฉ

- ุฑูุถ ุฃู ุทูุจ ุจุฏูู spec
- ุงุชุจุงุน ุงููุนุงููุฑ ูู `.kiro/steering/standards/`
- ุงูุชูุซูู ุฅูุฒุงูู ููู public APIs
- ุงูุงุฎุชุจุงุฑุงุช ุฅูุฒุงููุฉ (70%+ coverage)

ููุชูุงุตูู: ุฑุงุฌุน `.kiro/steering/reference/full-standards.md`
```

#### quick-reference.md (ูุฑุฌุน ุณุฑูุน)

```markdown
# ูุฑุฌุน ุณุฑูุน

## ุงูุชุณููุฉ

- Files/Folders: `snake_case`
- Classes: `PascalCase`
- Functions: `camelCase`
- Constants: `lowerCamelCase`

## ุงูุฌูุฏุฉ

- Test coverage: 70%+
- Max line length: 80
- Max complexity: 10
- DRY principle

## ุงูุฃูุงู

- No secrets in code
- Use secure storage
- Validate all inputs
- Hash passwords

## ุงูุชูุซูู

- DartDoc for public APIs
- Arabic for user-facing text
- Examples in docs

ููุชูุงุตูู: ุฑุงุฌุน ุงููููุงุช ูู `.kiro/steering/standards/`
```

### 2. Standards Files (ูููุงุช ุงููุนุงููุฑ)

ูู ููู ูุนุงููุฑ ูุฌุจ ุฃู ูููู:

- **ูุฎุชุตุฑ**: 200-300 ุณุทุฑ ูุญุฏ ุฃูุตู
- **ูุฑููุฒ**: ููุถูุน ูุงุญุฏ ููุท
- **ุนููู**: ููุงุนุฏ ูุงุถุญุฉ ูุฃูุซูุฉ ูุตูุฑุฉ
- **ูุฑุฌุนู**: ูุดูุฑ ูููููุงุช ุงูุชูุตูููุฉ ุนูุฏ ุงูุญุงุฌุฉ

#### ูุซุงู: naming.md (ูุฎุชุตุฑ)

```markdown
# ูุนุงููุฑ ุงูุชุณููุฉ

## ุงูููุงุนุฏ ุงูุฃุณุงุณูุฉ

| ุงูุนูุตุฑ    | ุงูุตูุบุฉ         | ูุซุงู                     |
| :-------- | :------------- | :----------------------- |
| Files     | snake_case     | customer_repository.dart |
| Classes   | PascalCase     | CustomerRepository       |
| Functions | camelCase      | getAllCustomers()        |
| Constants | lowerCamelCase | maxRetries               |

## ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ

โ `CustomerRepository.dart` - PascalCase ููููู
โ `customer_repository.dart` - snake_case

ููุฃูุซูุฉ ุงููุงููุฉ: `.kiro/steering/reference/naming-examples.md`
```

### 3. Guides (ุงูุฃุฏูุฉ)

ุงูุฃุฏูุฉ ุชูุญููู ููุท ุนูุฏ ุงูุนูู ุนูู ููุถูุน ูุญุฏุฏ:

- `flutter-guide.md` - ุนูุฏ ุงูุนูู ุนูู Flutter
- `git-guide.md` - ุนูุฏ ุงูุนูู ุนูู Git
- `security-guide.md` - ุนูุฏ ูุฑุงุฌุนุฉ ุงูุฃูุงู

### 4. Reference (ุงููุฑุงุฌุน)

ุงููุฑุงุฌุน ุงููุงููุฉ ุชูุญููู ููุท ุนูุฏ ุงูุทูุจ ุงูุตุฑูุญ:

- ุฃูุซูุฉ ุชูุตูููุฉ
- Best practices ูุงููุฉ
- ุญุงูุงุช ุงุณุชุฎุฏุงู ูุนูุฏุฉ

---

## Data Models

### Context Usage Model

```dart
class ContextUsage {
  final int totalTokens;
  final int usedTokens;
  final int remainingTokens;
  final double usagePercentage;
  final Map<String, int> breakdown;

  bool get isNearLimit => usagePercentage > 80;
  bool get isOverLimit => usagePercentage > 95;
}
```

### File Size Model

```dart
class FileSize {
  final String filePath;
  final int sizeInTokens;
  final int sizeInBytes;
  final double percentageOfContext;

  bool get isLarge => percentageOfContext > 10;
  bool get isTooLarge => percentageOfContext > 20;
}
```

---

## Implementation Plan

### Phase 1: ุชุญููู ุงููุถุน ุงูุญุงูู (ููู 1)

1. **ููุงุณ ุญุฌู ูู ููู ุชูุฌูู**

   - ุญุณุงุจ ุนุฏุฏ ุงูุฑููุฒ (tokens)
   - ุญุณุงุจ ุงููุณุจุฉ ูู ุงูุณูุงู ุงูููู
   - ุชุญุฏูุฏ ุงููููุงุช ุงูุฃูุจุฑ

2. **ุชุญููู ุงููุญุชูู**

   - ุชุญุฏูุฏ ุงููุญุชูู ุงูููุฑุฑ
   - ุชุญุฏูุฏ ุงููุญุชูู ุบูุฑ ุงูุถุฑูุฑู
   - ุชุญุฏูุฏ ุงููุญุชูู ุงููุงุฏุฑ ุงูุงุณุชุฎุฏุงู

3. **ุฅูุดุงุก ุชูุฑูุฑ**
   - ูุงุฆูุฉ ุจุงููููุงุช ุญุณุจ ุงูุญุฌู
   - ุชูุตูุงุช ููุชุญุณูู
   - ุฎุทุฉ ุงูุชูููุฐ

### Phase 2: ุฅุนุงุฏุฉ ุงูููููุฉ (ููู 2-3)

1. **ุฅูุดุงุก ุงูุจููุฉ ุงูุฌุฏูุฏุฉ**

   ```bash
   mkdir -p .kiro/steering/{core,standards,guides,reference}
   ```

2. **ุฅูุดุงุก ุงููููุงุช ุงูุฃุณุงุณูุฉ**

   - `core/philosophy.md` (ูุฎุชุตุฑ)
   - `core/quick-reference.md`
   - `core/team-identity.md`

3. **ุชูุณูู ุงููููุงุช ุงููุจูุฑุฉ**
   - ุงุณุชุฎุฑุงุฌ ุงููุญุชูู ุงูุฃุณุงุณู
   - ููู ุงูุชูุงุตูู ูููุฑุงุฌุน
   - ุฅูุดุงุก ุฑูุงุจุท ุจูู ุงููููุงุช

### Phase 3: ุงูุชุญุณูู (ููู 4-5)

1. **ุชูููู ุงูุญุฌู**

   - ุญุฐู ุงููุญุชูู ุงูููุฑุฑ
   - ุชูุฎูุต ุงููุญุชูู ุงูุทููู
   - ุงุณุชุฎุฏุงู ุฌุฏุงูู ุจุฏูุงู ูู ูุตูุต ุทูููุฉ

2. **ุชุญุณูู ุงูุชูุธูู**

   - ุชุฌููุน ุงูููุงุถูุน ุงููุชุดุงุจูุฉ
   - ุฅูุดุงุก ููุฑุณ ูุงุถุญ
   - ุฅุถุงูุฉ ุฑูุงุจุท ุณุฑูุนุฉ

3. **ุงูุงุฎุชุจุงุฑ**
   - ุงุฎุชุจุงุฑ ุชุญููู ุงููููุงุช ุงูุฌุฏูุฏุฉ
   - ููุงุณ ุงุณุชุฎุฏุงู ุงูุณูุงู
   - ุงูุชุฃูุฏ ูู ุนุฏู ููุฏุงู ูุนูููุงุช ูููุฉ

### Phase 4: ุงูุชูุซูู ูุงููุดุฑ (ููู 6)

1. **ุชูุซูู ุงูุชุบููุฑุงุช**

   - ูุชุงุจุฉ ุฏููู ุงูุงุณุชุฎุฏุงู
   - ุชูุซูู ุงูุจููุฉ ุงูุฌุฏูุฏุฉ
   - ุฅูุดุงุก ุฃูุซูุฉ

2. **ุงููุดุฑ**
   - ููู ุงููููุงุช ุงููุฏููุฉ ูู archive
   - ุชูุนูู ุงูุจููุฉ ุงูุฌุฏูุฏุฉ
   - ุชุญุฏูุซ ุงููุฑุงุฌุน

---

## Correctness Properties

### Property 1: ุญุฌู ุงููููุงุช ุงูุฃุณุงุณูุฉ

_For any_ ููู ูู `core/`, ูุฌุจ ุฃูุง ูุชุฌุงูุฒ ุญุฌูู 5% ูู ููุฒุงููุฉ ุงูุณูุงู
**Validates: Requirements 1.1**

### Property 2: ุนุฏู ุงูุชูุฑุงุฑ

_For any_ ูุญุชูู ูู ูููุงุช ุงูุชูุฌูู, ูุฌุจ ุฃูุง ูุชูุฑุฑ ูู ุฃูุซุฑ ูู ููู ูุงุญุฏ
**Validates: Requirements 1.2**

### Property 3: ุงูุชุญููู ุงูุงูุชูุงุฆู

_For any_ ููู ูู `guides/` ุฃู `reference/`, ูุฌุจ ุฃูุง ููุญููู ุฅูุง ุนูุฏ ุงูุทูุจ ุงูุตุฑูุญ
**Validates: Requirements 2.2**

### Property 4: ุงูุชุญุฐูุฑ ุงููุจูุฑ

_For any_ ุญุงูุฉ ููุชุฑุจ ูููุง ุงูุณูุงู ูู 80%, ูุฌุจ ุนุฑุถ ุชุญุฐูุฑ
**Validates: Requirements 3.1**

### Property 5: ุงูุงุฎุชุตุงุฑ

_For any_ ููู ุชูุฌูู ุฌุฏูุฏ, ูุฌุจ ุฃู ูููู ูุฎุชุตุฑุงู (< 300 ุณุทุฑ)
**Validates: Requirements 1.4**

---

## Error Handling

### ุญุงูุงุช ุงูุฎุทุฃ ุงููุชููุนุฉ

1. **ููู ููููุฏ**

   - ุนุฑุถ ุฑุณุงูุฉ ูุงุถุญุฉ
   - ุงูุชุฑุงุญ ุงูููู ุงูุจุฏูู
   - ุงููุชุงุจุนุฉ ุจุฏูู ุงูููู

2. **ููู ูุจูุฑ ุฌุฏุงู**

   - ุชุญุฐูุฑ ุงููุณุชุฎุฏู
   - ุงูุชุฑุงุญ ุชุญููู ุฌุฒุฆู
   - ุชูุฏูู ููุฎุต

3. **ุชุฌุงูุฒ ุงูุญุฏ**
   - ุฅููุงู ุงูุชุญููู
   - ุนุฑุถ ุชูุฑูุฑ ุงูุงุณุชุฎุฏุงู
   - ุงูุชุฑุงุญ ุญููู

---

## Testing Strategy

### Unit Tests

- ุงุฎุชุจุงุฑ ุญุณุงุจ ุญุฌู ุงููููุงุช
- ุงุฎุชุจุงุฑ ูุดู ุงูุชูุฑุงุฑ
- ุงุฎุชุจุงุฑ ุงูุชุญููู ุงูุงูุชูุงุฆู

### Integration Tests

- ุงุฎุชุจุงุฑ ุชุญููู ุงูุจููุฉ ุงููุงููุฉ
- ุงุฎุชุจุงุฑ ุงูุชุจุฏูู ุจูู ุงููููุงุช
- ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก

### Manual Tests

- ุงุฎุชุจุงุฑ ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู
- ุงุฎุชุจุงุฑ ุงููุถูุญ ูุงูููู
- ุงุฎุชุจุงุฑ ุงูููุงุกุฉ

---

## Performance Considerations

### ุงูุฃูุฏุงู

- ุชูููู ููุช ุงูุชุญููู ุจูุณุจุฉ 50%
- ุชูููู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ุจูุณุจุฉ 60%
- ุฒูุงุฏุฉ ุงููุณุงุญุฉ ุงููุชุงุญุฉ ููุนูู ุจูุณุจุฉ 70%

### ุงูุชุญุณููุงุช

- Lazy loading ูููููุงุช ุงููุจูุฑุฉ
- Caching ูููููุงุช ุงููุณุชุฎุฏูุฉ ุจูุซุฑุฉ
- Compression ูููุญุชูู ุงููุตู

---

## Migration Plan

### ุงูุฎุทูุงุช

1. **Backup**

   ```bash
   cp -r .kiro/steering .kiro/steering.backup
   ```

2. **Create New Structure**

   ```bash
   mkdir -p .kiro/steering/{core,standards,guides,reference}
   ```

3. **Migrate Files**

   - ููู ุงููุญุชูู ุงูุฃุณุงุณู ูู `core/`
   - ุชูุณูู ุงููููุงุช ุงููุจูุฑุฉ
   - ุฅูุดุงุก ุงูุฑูุงุจุท

4. **Test**

   - ุงุฎุชุจุงุฑ ุดุงูู
   - ููุงุณ ุงูุชุญุณูู
   - ุฌูุน feedback

5. **Deploy**
   - ุชูุนูู ุงูุจููุฉ ุงูุฌุฏูุฏุฉ
   - ุฃุฑุดูุฉ ุงููุฏููุฉ
   - ุชุญุฏูุซ ุงูุชูุซูู

---

## Success Metrics

| ุงููููุงุณ              | ุงูุญุงูู | ุงููุฏู | ุงูุชุญุณูู |
| :------------------- | :----: | :---: | :-----: |
| ุญุฌู ุงููููุงุช ุงูุฃุณุงุณูุฉ | ~150KB | ~50KB |   67%   |
| ุงุณุชุฎุฏุงู ุงูุณูุงู       |  90%+  | <50%  |   44%   |
| ุญุงูุงุช ุงูุชุฌุงูุฒ        | ูุชูุฑุฑ  | ูุงุฏุฑ  |   90%   |
| ููุช ุงูุชุญููู          |  ~5s   |  ~2s  |   60%   |

---

## Next Steps

1. โ ุฅูุดุงุก spec
2. ๐ ูุฑุงุฌุนุฉ ุงููุณุชุฎุฏู
3. โณ ุชูููุฐ Phase 1
4. โณ ุชูููุฐ Phase 2
5. โณ ุชูููุฐ Phase 3
6. โณ ุงููุดุฑ

---

**ุชู ุฅุนุฏุงุฏู ุจูุงุณุทุฉ:** ูุฑูู ูููุงุก ุชุทููุฑ ูุดุฑูุน ุจุตูุฑ  
**ุงูุชุงุฑูุฎ:** 7 ุฏูุณูุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** 1.0  
**ุงูุญุงูุฉ:** ๐ ููุฏ ุงููุฑุงุฌุนุฉ
