# متطلبات ميزة التعليمات التوضيحية (Onboarding Tutorial)

**المشروع:** بصير MVP  
**التاريخ:** 3 ديسمبر 2025  
**المؤلف:** فريق وكلاء تطوير مشروع بصير  
**الحالة:** ✅ معتمد

---

## 1. نظرة عامة

### 1.1 الهدف

إضافة نظام تعليمات توضيحية تفاعلي يساعد المستخدمين الجدد على فهم كيفية استخدام التطبيق بسهولة.

### 1.2 المشكلة

- المستخدمون الجدد قد يجدون صعوبة في فهم الواجهة
- عدم وضوح بعض الوظائف والأزرار
- الحاجة لتوجيه المستخدم خطوة بخطوة

### 1.3 الحل المقترح

نظام تعليمات توضيحية (Tutorial Overlay) يظهر عند أول استخدام لكل شاشة، مع إمكانية:

- عرض نصائح توضيحية لكل عنصر
- التنقل بين النصائح (التالي، السابق)
- تخطي التعليمات
- إخفاء التعليمات نهائياً

---

## 2. المتطلبات الوظيفية

### 2.1 عرض التعليمات

**FR-1:** يجب أن يظهر نظام التعليمات تلقائياً عند أول استخدام للتطبيق

**FR-2:** يجب أن يظهر نظام التعليمات لكل شاشة عند أول زيارة لها

**FR-3:** يجب أن تحتوي كل نصيحة على:

- عنوان واضح
- وصف مختصر
- سهم أو مؤشر يشير للعنصر المستهدف
- رقم النصيحة (مثل: 1/5)

**FR-4:** يجب أن يكون overlay شبه شفاف مع تسليط الضوء على العنصر المستهدف

### 2.2 التحكم في التعليمات

**FR-5:** يجب توفير زر "التالي" للانتقال للنصيحة التالية

**FR-6:** يجب توفير زر "السابق" للعودة للنصيحة السابقة (إن وجدت)

**FR-7:** يجب توفير زر "تخطي" لإغلاق التعليمات الحالية

**FR-8:** يجب توفير خيار "عدم الإظهار مرة أخرى" لإخفاء التعليمات نهائياً

**FR-9:** يجب حفظ حالة التعليمات (تم عرضها أم لا) لكل شاشة

### 2.3 إعادة عرض التعليمات

**FR-10:** يجب توفير خيار في الإعدادات لإعادة عرض جميع التعليمات

**FR-11:** يجب توفير زر مساعدة (؟) في كل شاشة لإعادة عرض تعليماتها

---

## 3. المتطلبات غير الوظيفية

### 3.1 الأداء

**NFR-1:** يجب ألا يؤثر نظام التعليمات على أداء التطبيق

**NFR-2:** يجب أن تكون الحركات الانتقالية سلسة (60fps)

**NFR-3:** يجب أن يكون وقت تحميل التعليمات < 100ms

### 3.2 سهولة الاستخدام

**NFR-4:** يجب أن تكون النصوص واضحة ومقروءة

**NFR-5:** يجب أن تكون الأزرار كبيرة وسهلة النقر (48x48px)

**NFR-6:** يجب دعم RTL بشكل كامل

**NFR-7:** يجب أن تكون الألوان متباينة (WCAG 2.1 Level AA)

### 3.3 الصيانة

**NFR-8:** يجب أن يكون النظام قابل للتوسع لإضافة تعليمات جديدة

**NFR-9:** يجب أن تكون التعليمات قابلة للتعديل بسهولة

**NFR-10:** يجب أن يكون الكود موثق بشكل جيد

---

## 4. الشاشات المستهدفة

### 4.1 المرحلة الأولى (MVP)

1. **Dashboard** - 4 نصائح

   - مرحباً بك في بصير
   - بطاقات الإحصائيات
   - الأزرار السريعة
   - شريط التنقل السفلي

2. **Customers** - 3 نصائح

   - قائمة العملاء
   - زر إضافة عميل
   - البحث والتصفية

3. **Invoices** - 3 نصائح

   - قائمة الفواتير
   - زر إضافة فاتورة
   - الفلاتر والتصدير

4. **Settings** - 2 نصائح
   - الإعدادات المتاحة
   - إعادة عرض التعليمات

### 4.2 المرحلة الثانية (مستقبلاً)

- شاشة إضافة عميل
- شاشة إضافة فاتورة
- شاشة تفاصيل العميل
- شاشة تفاصيل الفاتورة

---

## 5. تدفق المستخدم (User Flow)

### 5.1 أول استخدام

```
1. المستخدم يفتح التطبيق لأول مرة
2. يظهر overlay التعليمات على Dashboard
3. النصيحة الأولى: "مرحباً بك في بصير"
4. المستخدم ينقر "التالي"
5. النصيحة الثانية: "بطاقات الإحصائيات"
6. المستخدم ينقر "التالي"
7. ... وهكذا حتى النهاية
8. عند الانتهاء: "رائع! الآن أنت جاهز للبدء"
9. يتم حفظ أن التعليمات تم عرضها
```

### 5.2 تخطي التعليمات

```
1. المستخدم يشاهد نصيحة
2. المستخدم ينقر "تخطي"
3. يظهر حوار تأكيد: "هل تريد تخطي التعليمات؟"
4. خيارات:
   - "نعم، تخطي" - يغلق التعليمات
   - "لا، متابعة" - يعود للتعليمات
   - "عدم الإظهار مرة أخرى" - يخفي نهائياً
```

### 5.3 إعادة عرض التعليمات

```
1. المستخدم يذهب للإعدادات
2. ينقر على "إعادة عرض التعليمات"
3. يظهر حوار تأكيد
4. عند التأكيد: يتم إعادة تعيين جميع التعليمات
5. رسالة نجاح: "سيتم عرض التعليمات عند زيارة الشاشات"
```

---

## 6. البيانات المطلوب تخزينها

### 6.1 حالة التعليمات

```dart
class TutorialState {
  bool dashboardCompleted;
  bool customersCompleted;
  bool invoicesCompleted;
  bool settingsCompleted;
  bool neverShowAgain;
  DateTime? lastShown;
}
```

### 6.2 التخزين

- استخدام `SharedPreferences` لحفظ الحالة
- مفتاح التخزين: `tutorial_state`
- تنسيق JSON

---

## 7. التصميم المرئي

### 7.1 Overlay

- خلفية شبه شفافة: `Colors.black.withOpacity(0.7)`
- تسليط الضوء على العنصر: دائرة أو مستطيل شفاف
- حركة انتقالية سلسة

### 7.2 بطاقة النصيحة

```
┌─────────────────────────────────┐
│  [أيقونة]  عنوان النصيحة       │
│                                 │
│  وصف النصيحة هنا...            │
│                                 │
│  [1/4]                          │
│                                 │
│  [السابق]  [تخطي]  [التالي]    │
└─────────────────────────────────┘
```

### 7.3 الألوان

- خلفية البطاقة: `AppColors.surface`
- النص: `AppColors.textPrimary`
- الأزرار: `AppColors.primary`
- السهم المؤشر: `AppColors.secondary`

---

## 8. معايير القبول

### 8.1 الوظائف

- [ ] التعليمات تظهر عند أول استخدام
- [ ] التنقل بين النصائح يعمل بسلاسة
- [ ] زر تخطي يعمل بشكل صحيح
- [ ] خيار "عدم الإظهار مرة أخرى" يعمل
- [ ] إعادة عرض التعليمات من الإعدادات تعمل
- [ ] زر المساعدة (؟) يعمل في كل شاشة

### 8.2 الأداء

- [ ] لا تأثير على أداء التطبيق
- [ ] الحركات سلسة (60fps)
- [ ] وقت التحميل < 100ms

### 8.3 الجودة

- [ ] الكود نظيف ومنظم
- [ ] التوثيق كامل
- [ ] الاختبارات موجودة
- [ ] لا أخطاء في flutter analyze

---

## 9. المخاطر والتحديات

### 9.1 المخاطر

| المخاطرة         | الاحتمالية | التأثير | الحل                              |
| :--------------- | :--------- | :------ | :-------------------------------- |
| تأثير على الأداء | منخفض      | متوسط   | تحسين الكود واستخدام lazy loading |
| تعقيد التطبيق    | متوسط      | منخفض   | تصميم بسيط وواضح                  |
| صعوبة الصيانة    | منخفض      | متوسط   | كود منظم وموثق جيداً              |

### 9.2 التحديات

1. **تحديد موضع السهم المؤشر**

   - الحل: استخدام GlobalKey للحصول على موضع العنصر

2. **دعم RTL**

   - الحل: استخدام Directionality واختبار شامل

3. **التوافق مع جميع أحجام الشاشات**
   - الحل: استخدام MediaQuery وتصميم responsive

---

## 10. الجدول الزمني

| المرحلة      | المدة            | الوصف                  |
| :----------- | :--------------- | :--------------------- |
| التصميم      | 1 يوم            | تصميم النظام والمكونات |
| التطوير      | 2-3 أيام         | تطبيق النظام           |
| الاختبار     | 1 يوم            | اختبار شامل            |
| التوثيق      | 0.5 يوم          | توثيق كامل             |
| **الإجمالي** | **4.5-5.5 أيام** |                        |

---

## 11. التبعيات

### 11.1 المكتبات المطلوبة

```yaml
dependencies:
  shared_preferences: ^2.2.2 # لحفظ حالة التعليمات

dev_dependencies:
  # لا توجد تبعيات إضافية
```

### 11.2 الملفات المطلوبة

- `lib/core/tutorial/` - مجلد النظام
- `lib/core/tutorial/tutorial_overlay.dart` - Overlay الرئيسي
- `lib/core/tutorial/tutorial_step.dart` - نموذج الخطوة
- `lib/core/tutorial/tutorial_controller.dart` - التحكم
- `lib/core/tutorial/tutorial_storage.dart` - التخزين

---

## 12. المراجع

- [Material Design - Onboarding](https://material.io/design/communication/onboarding.html)
- [Flutter Tutorial Overlay Package](https://pub.dev/packages/tutorial_coach_mark)
- [WCAG 2.1 Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)

---

**تم إعداده بواسطة:** فريق وكلاء تطوير مشروع بصير  
**التاريخ:** 3 ديسمبر 2025  
**الحالة:** ✅ معتمد للتنفيذ
