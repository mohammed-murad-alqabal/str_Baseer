# L2 Decision Layer - ุทุจูุฉ ุงููุฑุงุฑ ุงูุฐููุฉ

**ุงููุดุฑูุน:** ุจุตูุฑ MVP  
**ุงููุคูู:** ูุฑูู ูููุงุก ุชุทููุฑ ูุดุฑูุน ุจุตูุฑ  
**ุงูุชุงุฑูุฎ:** 11 ุฏูุณูุจุฑ 2025  
**ุงูุญุงูุฉ:** โ **ููุชูู**

---

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

L2 Decision Layer ูู ุงูุทุจูุฉ ุงูุซุงููุฉ ูู ูุธุงู ุงููููุงุก ุงูุฐููุฉ ููุดุฑูุน ุจุตูุฑ MVP. ุชุณุชูุจู ูุฐู ุงูุทุจูุฉ ุงูุจูุงูุงุช ูู L1 Analysis Layer ูุชุชุฎุฐ ูุฑุงุฑุงุช ุฐููุฉ ุจูุงุกู ุนูู ุงูููุงุนุฏ ุงููุญุฏุฏุฉ ูุณุจูุงู ูููุงุฐุฌ ุงูุชุนูู ุงูุขูู.

## ๐๏ธ ุงููุนูุงุฑูุฉ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    L2 Decision Layer                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ   Decision  โ  โ    Rule     โ  โ    ML Models        โ  โ
โ  โ   Engine    โโโโค  Processor  โ  โ    Manager          โ  โ
โ  โ             โ  โ             โ  โ                     โ  โ
โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโ  โ
โ         โ                 โ                    โ            โ
โ         โผ                 โผ                    โผ            โ
โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ   Context   โ  โ   Action    โ  โ     Event           โ  โ
โ  โ   Manager   โ  โ  Executor   โ  โ    Publisher        โ  โ
โ  โ             โ  โ             โ  โ                     โ  โ
โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ฆ ุงูููููุงุช ุงูุฑุฆูุณูุฉ

### 1. Decision Engine (ูุญุฑู ุงููุฑุงุฑุงุช)
- **ุงูููู:** `engine/decision-engine.ts`
- **ุงููุธููุฉ:** ุงููููู ุงูุฃุณุงุณู ูุงุชุฎุงุฐ ุงููุฑุงุฑุงุช
- **ุงููุณุคูููุงุช:**
  - ูุนุงูุฌุฉ ุจูุงูุงุช ุงูุชุญููู ูู L1
  - ุชูููู ุงูููุงุนุฏ ูุงูุญุตูู ุนูู ุชููุนุงุช ML
  - ุชุฑุชูุจ ุงููุฑุงุฑุงุช ุญุณุจ ุงูุฃููููุฉ
  - ุงูุชุญูู ูู ุงูุชุนุงุฑุถุงุช ูุงูุชุจุนูุงุช
  - ุชูููุฐ ุงููุฑุงุฑุงุช ูุงูุชุฑุงุฌุน ุนููุง

### 2. Rule Processor (ูุนุงูุฌ ุงูููุงุนุฏ)
- **ุงูููู:** `rules/rule-processor.ts`
- **ุงููุธููุฉ:** ุฅุฏุงุฑุฉ ูุชูููุฐ ููุงุนุฏ ุงููุฑุงุฑ
- **ุงููุณุคูููุงุช:**
  - ุชุญููู ุงูููุงุนุฏ ูู ูููุงุช YAML
  - ุชูููู ุงูุดุฑูุท ูุงูููุงุนุฏ
  - ุญู ุงูุชุนุงุฑุถุงุช ุจูู ุงูููุงุนุฏ
  - ุชุญุณูู ุฃุฏุงุก ุชูููุฐ ุงูููุงุนุฏ

### 3. ML Models Manager (ูุฏูุฑ ููุงุฐุฌ ุงูุชุนูู ุงูุขูู)
- **ุงูููู:** `ml/ml-models-manager.ts`
- **ุงููุธููุฉ:** ุฅุฏุงุฑุฉ ููุงุฐุฌ ุงูุชุนูู ุงูุขูู
- **ุงููุณุคูููุงุช:**
  - ุชุญููู ูุญูุธ ุงูููุงุฐุฌ
  - ุชุฏุฑูุจ ุงูููุงุฐุฌ ุนูู ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ
  - ุงูุชูุจุค ุจุงููุฑุงุฑุงุช
  - ุชูููู ุฃุฏุงุก ุงูููุงุฐุฌ

### 4. Context Manager (ูุฏูุฑ ุงูุณูุงู)
- **ุงูููู:** `context/context-manager.ts`
- **ุงููุธููุฉ:** ุฅุฏุงุฑุฉ ุณูุงู ุงููุฑุงุฑุงุช ูุงูุญุงูุฉ
- **ุงููุณุคูููุงุช:**
  - ุชุชุจุน ุญุงูุฉ ุงููุธุงู
  - ุฅุฏุงุฑุฉ ุงูุชุจุนูุงุช ุจูู ุงููุฑุงุฑุงุช
  - ูุดู ุงูุชุนุงุฑุถุงุช
  - ุญูุธ ุชุงุฑูุฎ ุงูุณูุงู

### 5. Action Executor (ูููุฐ ุงูุฅุฌุฑุงุกุงุช)
- **ุงูููู:** `actions/action-executor.ts`
- **ุงููุธููุฉ:** ุชูููุฐ ุฅุฌุฑุงุกุงุช ุงููุฑุงุฑุงุช
- **ุงููุณุคูููุงุช:**
  - ุชูููุฐ ุงูุฅุฌุฑุงุกุงุช ุจุฃูุงู
  - ูุฑุงูุจุฉ ุชูุฏู ุงูุชูููุฐ
  - ุงูุชุฑุงุฌุน ุนู ุงูุฅุฌุฑุงุกุงุช
  - ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

## ๐ ุงูุงุณุชุฎุฏุงู

### ุงูุชุดุบูู ุงูุฃุณุงุณู

```typescript
import { L2DecisionLayer } from './l2-decision-layer';

// ุฅูุดุงุก ุทุจูุฉ ุงููุฑุงุฑ
const l2Layer = new L2DecisionLayer();

// ุจุฏุก ุงูุทุจูุฉ
await l2Layer.start();

// ูุนุงูุฌุฉ ุจูุงูุงุช ุงูุชุญููู
const analysisData = {
  source: 'flutter',
  timestamp: new Date(),
  metrics: {
    performance: { cpu: 85, memory: 70 },
    flutter: { buildTime: 12000, widgetCount: 150 },
    riverpod: { rebuildsPerMinute: 120 }
  }
};

const result = await l2Layer.processAnalysisData(analysisData);
console.log('Decisions made:', result.decisions.length);

// ุฅููุงู ุงูุทุจูุฉ
await l2Layer.stop();
```

### ุงูุชูููู ุงููุฎุตุต

```typescript
import { L2DecisionLayer, getBasserMVPConfig } from './l2-decision-layer';

// ุงูุญุตูู ุนูู ุชูููู ูุดุฑูุน ุจุตูุฑ
const config = getBasserMVPConfig();

// ุชุฎุตูุต ุงูุชูููู
config.engine.confidenceThreshold = 0.8;
config.ml.enablePredictions = true;

// ุฅูุดุงุก ุงูุทุจูุฉ ูุน ุงูุชูููู ุงููุฎุตุต
const l2Layer = new L2DecisionLayer(config);
```

## โ๏ธ ุงูุชูููู

### ููู ุงูุชูููู ุงูุงูุชุฑุงุถู

```typescript
const config = {
  project: 'ุจุตูุฑ MVP',
  
  engine: {
    maxConcurrentDecisions: 8,
    decisionTimeout: 300000,
    confidenceThreshold: 0.75
  },
  
  rules: {
    rulesPath: '.kiro/config/basser-rules.yml',
    autoReload: true,
    cacheTimeout: 300000
  },
  
  ml: {
    modelsPath: '.kiro/data/basser-models',
    autoUpdate: true,
    confidenceThreshold: 0.6
  },
  
  actions: {
    maxConcurrentActions: 5,
    defaultTimeout: 60000,
    enableRollback: true
  }
};
```

### ููุงุนุฏ ุงููุฑุงุฑ (YAML)

```yaml
# .kiro/config/basser-rules.yml
rules:
  flutter_performance:
    - id: "widget_optimization"
      name: "Widget Performance Optimization"
      description: "ุชุญุณูู ุฃุฏุงุก ุงูููุฏุฌุช"
      conditions:
        - field: "flutter.buildTime"
          operator: ">"
          value: 10000
          type: "number"
      actions:
        - type: "optimize_widget"
          description: "ุชุญุณูู ุฃุฏุงุก ุงูููุฏุฌุช"
          parameters:
            target: "stateful_widgets"
      priority: 8
      enabled: true

  riverpod_optimization:
    - id: "provider_efficiency"
      name: "Riverpod Provider Optimization"
      description: "ุชุญุณูู ููุงุกุฉ ูููุฑู Riverpod"
      conditions:
        - field: "riverpod.rebuildsPerMinute"
          operator: ">"
          value: 100
          type: "number"
      actions:
        - type: "optimize_providers"
          description: "ุชุญุณูู ูููุฑู Riverpod"
          parameters:
            strategy: "reduce_rebuilds"
      priority: 7
      enabled: true
```

## ๐ฏ ุฃููุงุน ุงููุฑุงุฑุงุช ุงููุฏุนููุฉ

### Flutter Performance
- `OPTIMIZE_WIDGET` - ุชุญุณูู ุฃุฏุงุก ุงูููุฏุฌุช
- `REDUCE_REBUILDS` - ุชูููู ุฅุนุงุฏุฉ ุงูุจูุงุก
- `IMPROVE_RENDERING` - ุชุญุณูู ุงูุฑุณู

### State Management (Riverpod)
- `OPTIMIZE_PROVIDERS` - ุชุญุณูู ุงููููุฑูู
- `REFACTOR_STATE` - ุฅุนุงุฏุฉ ููููุฉ ุงูุญุงูุฉ
- `ADD_CACHING` - ุฅุถุงูุฉ ุงูุชุฎุฒูู ุงููุคูุช

### Database (Isar)
- `OPTIMIZE_QUERIES` - ุชุญุณูู ุงูุงุณุชุนูุงูุงุช
- `ADD_INDEXES` - ุฅุถุงูุฉ ุงูููุงุฑุณ
- `CLEANUP_DATA` - ุชูุธูู ุงูุจูุงูุงุช

### Code Quality
- `REFACTOR_CODE` - ุฅุนุงุฏุฉ ููููุฉ ุงูููุฏ
- `ADD_TESTS` - ุฅุถุงูุฉ ุงูุงุฎุชุจุงุฑุงุช
- `UPDATE_DEPENDENCIES` - ุชุญุฏูุซ ุงูุชุจุนูุงุช

### System Health
- `SCALE_RESOURCES` - ุชูุณูุน ุงูููุงุฑุฏ
- `RESTART_SERVICES` - ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุฏูุงุช
- `ALERT_TEAM` - ุชูุจูู ุงููุฑูู

## ๐ค ููุงุฐุฌ ุงูุชุนูู ุงูุขูู

### ุงูููุงุฐุฌ ุงูุงูุชุฑุงุถูุฉ

#### 1. ูุญุณู ุงูุฃุฏุงุก (Performance Optimizer)
- **ุงูููุน:** Classification
- **ุงููุฏู:** ุชุญุฏูุฏ ููุน ุงูุชุญุณูู ุงููุทููุจ
- **ุงููุนุงูู:**
  - `performance_cpu`
  - `performance_memory`
  - `flutter_build_time`
  - `riverpod_rebuilds`
  - `isar_query_time`

#### 2. ูุตูู ุฌูุฏุฉ ุงูููุฏ (Code Quality Classifier)
- **ุงูููุน:** Classification
- **ุงููุฏู:** ุชูููู ุฌูุฏุฉ ุงูููุฏ
- **ุงููุนุงูู:**
  - `code_complexity`
  - `test_coverage`
  - `code_duplication`
  - `documentation_ratio`

### ุชุฏุฑูุจ ุงูููุงุฐุฌ

```typescript
// ุชุฏุฑูุจ ูููุฐุฌ ุฌุฏูุฏ
const trainingData = {
  features: [
    { performance_cpu: 85, flutter_build_time: 12000 },
    { performance_cpu: 45, flutter_build_time: 3000 }
  ],
  targets: ['optimize_widget', 'no_action'],
  metadata: {
    source: 'production_data',
    timestamp: new Date(),
    quality: 0.9
  }
};

await l2Layer.mlManager.trainModel('performance_optimizer', trainingData);
```

## ๐ ุงููุฑุงูุจุฉ ูุงูููุงููุณ

### ููุงููุณ ุงูุฃุฏุงุก
- `decisionsPerMinute` - ุงููุฑุงุฑุงุช ูู ุงูุฏูููุฉ
- `averageDecisionTime` - ูุชูุณุท ููุช ุงููุฑุงุฑ
- `ruleEvaluationTime` - ููุช ุชูููู ุงูููุงุนุฏ
- `mlPredictionTime` - ููุช ุงูุชูุจุค ุจุงูุชุนูู ุงูุขูู

### ููุงููุณ ุงูุฌูุฏุฉ
- `decisionAccuracy` - ุฏูุฉ ุงููุฑุงุฑุงุช
- `ruleEffectiveness` - ูุนุงููุฉ ุงูููุงุนุฏ
- `mlModelAccuracy` - ุฏูุฉ ููุงุฐุฌ ุงูุชุนูู ุงูุขูู
- `actionSuccessRate` - ูุนุฏู ูุฌุงุญ ุงูุฅุฌุฑุงุกุงุช

### ููุงููุณ ุงููุธุงู
- `memoryUsage` - ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ
- `cpuUsage` - ุงุณุชุฎุฏุงู ุงููุนุงูุฌ
- `activeDecisions` - ุงููุฑุงุฑุงุช ุงููุดุทุฉ
- `queuedDecisions` - ุงููุฑุงุฑุงุช ูู ุงูุงูุชุธุงุฑ

## ๐ง ุงูุฃุญุฏุงุซ (Events)

### ุฃุญุฏุงุซ ุงูุทุจูุฉ
- `layerStarted` - ุจุฏุก ุงูุทุจูุฉ
- `layerStopped` - ุฅููุงู ุงูุทุจูุฉ
- `analysisProcessed` - ูุนุงูุฌุฉ ุงูุชุญููู
- `configUpdated` - ุชุญุฏูุซ ุงูุชูููู

### ุฃุญุฏุงุซ ุงููุฑุงุฑุงุช
- `decisionMade` - ุงุชุฎุงุฐ ูุฑุงุฑ
- `decisionExecuted` - ุชูููุฐ ูุฑุงุฑ
- `decisionCompleted` - ุฅููุงู ูุฑุงุฑ
- `decisionFailed` - ูุดู ูุฑุงุฑ
- `decisionRolledBack` - ุงูุชุฑุงุฌุน ุนู ูุฑุงุฑ

### ุฃุญุฏุงุซ ุงูููุงุนุฏ ูุงูุชุนูู ุงูุขูู
- `ruleTriggered` - ุชุทุจูู ูุงุนุฏุฉ
- `mlPrediction` - ุชููุน ุงูุชุนูู ุงูุขูู
- `conflictsDetected` - ูุดู ุชุนุงุฑุถุงุช

## ๐ก๏ธ ุงูุฃูุงู

### ุชุณุฌูู ุงููุฑุงุฌุนุฉ
- ุฌููุน ุงููุฑุงุฑุงุช ูุณุฌูุฉ ูุน ุงูููุช ูุงููุจุฑุฑ
- ุชุชุจุน ุชูููุฐ ุงูุฅุฌุฑุงุกุงุช ูุงููุชุงุฆุฌ
- ุญูุธ ุชุงุฑูุฎ ุงูุชุบููุฑุงุช ูู ุงูุณูุงู

### ุงูุชุญูู ูู ุงููุตูู
- ุฅููุงููุฉ ุชูุนูู ุงูุชุญูู ูู ุงููุตูู
- ุชุดููุฑ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ
- ุญูุงูุฉ ูููุงุช ุงูุชูููู

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช

```bash
# ุชุดุบูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช
npm test

# ุชุดุบูู ุงุฎุชุจุงุฑุงุช ูููู ูุนูู
npm test -- --grep "DecisionEngine"

# ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช ูุน ุงูุชุบุทูุฉ
npm run test:coverage
```

### ุงุฎุชุจุงุฑ ุงูุชูุงูู

```typescript
// ุงุฎุชุจุงุฑ ุชูุงูู L1 ู L2
const l1Layer = new L1AnalysisLayer();
const l2Layer = new L2DecisionLayer();

await l1Layer.start();
await l2Layer.start();

// ุฑุจุท ุงูุทุจูุงุช
l1Layer.on('analysisCompleted', async (result) => {
  await l2Layer.processAnalysisData(result);
});
```

## ๐ ุงูุฃุฏุงุก

### ุงูุชุญุณููุงุช ุงููุทุจูุฉ
- ุชุฎุฒูู ูุคูุช ูุชูููู ุงูููุงุนุฏ
- ูุนุงูุฌุฉ ูุชูุงุฒูุฉ ูููุฑุงุฑุงุช
- ุชุญุณูู ุงุณุชุนูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุถุบุท ุงูุจูุงูุงุช ุงููุญููุธุฉ

### ูุนุงููุฑ ุงูุฃุฏุงุก
- ูุนุงูุฌุฉ 100+ ูุฑุงุฑ ูู ุงูุฏูููุฉ
- ููุช ุงุณุชุฌุงุจุฉ ุฃูู ูู 100ms ููููุงุนุฏ ุงูุจุณูุทุฉ
- ููุช ุงุณุชุฌุงุจุฉ ุฃูู ูู 500ms ูุชููุนุงุช ุงูุชุนูู ุงูุขูู
- ุงุณุชุฎุฏุงู ุฐุงูุฑุฉ ุฃูู ูู 256MB

## ๐ ุงูุชุทููุฑ ุงููุณุชูุจูู

### ุงูููุฒุงุช ุงููุฎุทุทุฉ
- ุฏุนู ููุงุนุฏ ุฏููุงููููุฉ ุฃูุซุฑ ุชุนููุฏุงู
- ุชุญุณูู ููุงุฐุฌ ุงูุชุนูู ุงูุขูู
- ูุงุฌูุฉ ููุจ ููุฑุงูุจุฉ ุงููุฑุงุฑุงุช
- ุชูุงูู ูุน ุฃูุธูุฉ CI/CD

### ุงูุชุญุณููุงุช ุงูููุชุฑุญุฉ
- ุฏุนู ุงูุชุนูู ุงูุชุนุฒูุฒู
- ุชุญููู ุชุฃุซูุฑ ุงููุฑุงุฑุงุช
- ุชููุน ุงูุฃุฏุงุก ุงููุณุชูุจูู
- ุชุญุณูู ุงุณุชููุงู ุงูููุงุฑุฏ

---

## ๐ ุงูุฏุนู

ููุญุตูู ุนูู ุงููุณุงุนุฏุฉ ุฃู ุงูุฅุจูุงุบ ุนู ุงููุดุงูู:

- **ุงูุชูุซูู:** `.kiro/docs/`
- **ุงูุฃูุซูุฉ:** `.kiro/examples/`
- **ุงูุณุฌูุงุช:** `.kiro/logs/`

---

**ุชู ุจูุงุณุทุฉ:** ูุฑูู ูููุงุก ุชุทููุฑ ูุดุฑูุน ุจุตูุฑ  
**ุขุฎุฑ ุชุญุฏูุซ:** 11 ุฏูุณูุจุฑ 2025