# ðŸ—ï¸ Ø§Ù„ØªØµØ§Ù…ÙŠÙ… Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© - Baseer

## ðŸ“‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©

| Ø§Ù„Ø­Ù‚Ù„ | Ø§Ù„Ù‚ÙŠÙ…Ø© |
|-------|--------|
| **Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹** | Baseer - Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠ Ø§Ù„Ø°ÙƒÙŠ |
| **Ø§Ù„Ø¥ØµØ¯Ø§Ø±** | 1.0.0 |
| **Ø§Ù„ØªØ§Ø±ÙŠØ®** | 21 Ø£ÙƒØªÙˆØ¨Ø± 2025 |
| **Ø§Ù„Ù…Ø¤Ù„Ù** | ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ± |
| **Ø§Ù„Ø­Ø§Ù„Ø©** | Ù…Ø³ÙˆØ¯Ø© Ø£ÙˆÙ„ÙŠØ© |
| **Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©** | v1.0 |

---

## ðŸŽ¯ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØµØ§Ù…ÙŠÙ…

### Ø§Ù„Ù‡Ø¯Ù Ù…Ù† Ø§Ù„ØªØµØ§Ù…ÙŠÙ…
ØªÙˆÙÙŠØ± ØªØµØ§Ù…ÙŠÙ… Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ù…ÙØµÙ„Ø© ÙˆØ¯Ù‚ÙŠÙ‚Ø© Ù„Ø¬Ù…ÙŠØ¹ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…ØŒ Ù…Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¨Ù„ÙŠØ© Ù„Ù„ØªÙˆØ³Ø¹ ÙˆØ§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø£Ø¯Ø§Ø¡.

### Ø§Ù„Ù…Ø¨Ø§Ø¯Ø¦ Ø§Ù„ØªØµÙ…ÙŠÙ…ÙŠØ©
1. **Microservices Architecture**: Ø®Ø¯Ù…Ø§Øª Ù…Ù†ÙØµÙ„Ø© ÙˆÙ‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙˆØ³Ø¹
2. **Domain-Driven Design**: ØªØµÙ…ÙŠÙ… Ù…Ø¯ÙÙˆØ¹ Ø¨Ø§Ù„Ù…Ø¬Ø§Ù„
3. **Event-Driven Architecture**: Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ù…Ø¯ÙÙˆØ¹Ø© Ø¨Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
4. **API-First Design**: ØªØµÙ…ÙŠÙ… API Ø£ÙˆÙ„Ø§Ù‹
5. **Security by Design**: Ø§Ù„Ø£Ù…Ø§Ù† ÙÙŠ Ø§Ù„ØªØµÙ…ÙŠÙ…
6. **Scalability**: Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªÙˆØ³Ø¹ Ø§Ù„Ø£ÙÙ‚ÙŠ ÙˆØ§Ù„Ø¹Ù…ÙˆØ¯ÙŠ

---

## ðŸ›ï¸ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠ Ø§Ù„Ø¹Ø§Ù…

### 1. Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Baseer System Architecture              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Frontend Layer (Flutter)                                   â”‚
â”‚  â”œâ”€â”€ Mobile App (iOS/Android)                              â”‚
â”‚  â””â”€â”€ Web Dashboard (React)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  API Gateway Layer                                          â”‚
â”‚  â”œâ”€â”€ Authentication & Authorization                         â”‚
â”‚  â”œâ”€â”€ Rate Limiting & Throttling                            â”‚
â”‚  â”œâ”€â”€ Request Routing & Load Balancing                      â”‚
â”‚  â””â”€â”€ API Versioning & Documentation                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Microservices Layer                                       â”‚
â”‚  â”œâ”€â”€ Auth Service      â”œâ”€â”€ Invoice Service                 â”‚
â”‚  â”œâ”€â”€ User Service      â”œâ”€â”€ OCR Service                     â”‚
â”‚  â”œâ”€â”€ Customer Service  â”œâ”€â”€ Analytics Service               â”‚
â”‚  â””â”€â”€ Payment Service   â””â”€â”€ Notification Service            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Data Layer                                                 â”‚
â”‚  â”œâ”€â”€ PostgreSQL (Primary Database)                         â”‚
â”‚  â”œâ”€â”€ Redis (Cache & Sessions)                              â”‚
â”‚  â””â”€â”€ S3 (File Storage)                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Infrastructure Layer                                       â”‚
â”‚  â”œâ”€â”€ AWS Services (EC2, RDS, ElastiCache, S3)              â”‚
â”‚  â”œâ”€â”€ Kubernetes (Container Orchestration)                  â”‚
â”‚  â”œâ”€â”€ Monitoring (Prometheus, Grafana)                       â”‚
â”‚  â””â”€â”€ Logging (ELK Stack)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…
```
User Request â†’ API Gateway â†’ Microservice â†’ Database
     â†“              â†“            â†“           â†“
   Response â† API Gateway â† Microservice â† Database
```

---

## ðŸ”§ ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ÙŠÙƒØ±ÙˆØ³ÙŠØ±ÙÙŠØ³

### 1. Auth Service (Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©)

#### Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª
- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
- Ø¥ØµØ¯Ø§Ø± ÙˆØ¥Ø¯Ø§Ø±Ø© JWT tokens
- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª ÙˆØ§Ù„Ø£Ø°ÙˆÙ†Ø§Øª
- Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠØ©

#### API Endpoints
```yaml
POST /auth/register
POST /auth/login
POST /auth/logout
POST /auth/refresh
POST /auth/forgot-password
POST /auth/reset-password
POST /auth/verify-email
POST /auth/2fa/enable
POST /auth/2fa/verify
GET  /auth/profile
PUT  /auth/profile
PUT  /auth/password
```

#### Database Schema
```sql
-- Users table
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    first_name VARCHAR(100) NOT NULL,
    last_name VARCHAR(100) NOT NULL,
    phone VARCHAR(20),
    business_name VARCHAR(200),
    business_type VARCHAR(50),
    tax_number VARCHAR(15),
    cr_number VARCHAR(10),
    subscription_plan VARCHAR(20) DEFAULT 'free',
    subscription_status VARCHAR(20) DEFAULT 'active',
    email_verified BOOLEAN DEFAULT FALSE,
    phone_verified BOOLEAN DEFAULT FALSE,
    two_factor_enabled BOOLEAN DEFAULT FALSE,
    two_factor_secret VARCHAR(255),
    last_login TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- User sessions table
CREATE TABLE user_sessions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id),
    token_hash VARCHAR(255) NOT NULL,
    device_info JSONB,
    ip_address INET,
    expires_at TIMESTAMP NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### Service Architecture
```go
type AuthService struct {
    userRepo    UserRepository
    sessionRepo SessionRepository
    jwtService  JWTService
    emailService EmailService
    smsService  SMSService
    logger      Logger
}

type UserRepository interface {
    Create(ctx context.Context, user *User) error
    GetByEmail(ctx context.Context, email string) (*User, error)
    GetByID(ctx context.Context, id string) (*User, error)
    Update(ctx context.Context, user *User) error
    Delete(ctx context.Context, id string) error
}
```

### 2. Invoice Service (Ø®Ø¯Ù…Ø© Ø§Ù„ÙÙˆØ§ØªÙŠØ±)

#### Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª
- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙÙˆØ§ØªÙŠØ± ÙˆØ§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©
- ØªÙƒØ§Ù…Ù„ Ù…Ø¹ ZATCA
- Ø¥Ù†Ø´Ø§Ø¡ PDF Ùˆ QR codes
- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª

#### API Endpoints
```yaml
GET    /invoices
POST   /invoices
GET    /invoices/{id}
PUT    /invoices/{id}
DELETE /invoices/{id}
POST   /invoices/{id}/send
POST   /invoices/{id}/pay
GET    /invoices/{id}/pdf
GET    /invoices/{id}/qr
POST   /invoices/{id}/zatca/submit
```

#### Database Schema
```sql
-- Invoices table
CREATE TABLE invoices (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id),
    customer_id UUID NOT NULL REFERENCES customers(id),
    invoice_number VARCHAR(50) UNIQUE NOT NULL,
    invoice_type VARCHAR(20) DEFAULT 'standard',
    status VARCHAR(20) DEFAULT 'draft',
    issue_date DATE NOT NULL,
    due_date DATE NOT NULL,
    subtotal DECIMAL(15,2) NOT NULL,
    tax_amount DECIMAL(15,2) DEFAULT 0,
    discount_amount DECIMAL(15,2) DEFAULT 0,
    total_amount DECIMAL(15,2) NOT NULL,
    currency VARCHAR(3) DEFAULT 'SAR',
    payment_method VARCHAR(50),
    payment_status VARCHAR(20) DEFAULT 'unpaid',
    paid_amount DECIMAL(15,2) DEFAULT 0,
    paid_date TIMESTAMP,
    payment_reference VARCHAR(100),
    zatca_uuid VARCHAR(100),
    zatca_hash VARCHAR(255),
    qr_code TEXT,
    xml_content TEXT,
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Invoice items table
CREATE TABLE invoice_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    invoice_id UUID NOT NULL REFERENCES invoices(id),
    item_name VARCHAR(200) NOT NULL,
    description TEXT,
    quantity DECIMAL(10,3) NOT NULL,
    unit_price DECIMAL(15,2) NOT NULL,
    discount DECIMAL(5,2) DEFAULT 0,
    discount_type VARCHAR(20) DEFAULT 'percentage',
    tax_rate DECIMAL(5,2) DEFAULT 15,
    line_total DECIMAL(15,2) NOT NULL,
    discount_amount DECIMAL(15,2) DEFAULT 0,
    tax_amount DECIMAL(15,2) DEFAULT 0,
    total_amount DECIMAL(15,2) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### Service Architecture
```go
type InvoiceService struct {
    invoiceRepo InvoiceRepository
    customerRepo CustomerRepository
    zatcaClient ZATCAClient
    pdfService PDFService
    qrService QRService
    emailService EmailService
    logger Logger
}

type InvoiceRepository interface {
    Create(ctx context.Context, invoice *Invoice) error
    GetByID(ctx context.Context, id string) (*Invoice, error)
    GetByUserID(ctx context.Context, userID string, pagination *Pagination) ([]*Invoice, error)
    Update(ctx context.Context, invoice *Invoice) error
    Delete(ctx context.Context, id string) error
    GetByStatus(ctx context.Context, status string) ([]*Invoice, error)
}
```

### 3. OCR Service (Ø®Ø¯Ù…Ø© Ù…Ø³Ø­ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª)

#### Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª
- Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª
- ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Google Vision API
- Ø§Ø³ØªØ®Ù„Ø§Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
- ØªØ­Ø³ÙŠÙ† Ø¯Ù‚Ø© OCR

#### API Endpoints
```yaml
POST /ocr/scan
POST /ocr/scan/batch
GET  /ocr/scan/{id}/status
GET  /ocr/scan/{id}/result
POST /ocr/scan/{id}/verify
GET  /ocr/templates
POST /ocr/templates
```

#### Service Architecture
```go
type OCRService struct {
    visionClient *vision.ImageAnnotatorClient
    imageProcessor ImageProcessor
    dataExtractor DataExtractor
    templateService TemplateService
    storageService StorageService
    logger Logger
}

type ImageProcessor interface {
    PreprocessImage(image []byte) ([]byte, error)
    EnhanceImage(image []byte) ([]byte, error)
    ExtractText(image []byte) (string, error)
}

type DataExtractor interface {
    ExtractInvoiceData(text string) (*InvoiceData, error)
    ExtractExpenseData(text string) (*ExpenseData, error)
    ValidateExtractedData(data interface{}) error
}
```

### 4. Analytics Service (Ø®Ø¯Ù…Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª)

#### Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª
- Ø¬Ù…Ø¹ ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©
- Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
- Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„ØªÙ†Ø¨Ø¤ÙŠØ©
- Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

#### API Endpoints
```yaml
GET /analytics/dashboard
GET /analytics/revenue
GET /analytics/expenses
GET /analytics/customers
GET /analytics/invoices
GET /analytics/predictions
GET /analytics/reports
POST /analytics/reports/generate
```

#### Service Architecture
```go
type AnalyticsService struct {
    invoiceRepo InvoiceRepository
    expenseRepo ExpenseRepository
    customerRepo CustomerRepository
    reportGenerator ReportGenerator
    chartService ChartService
    predictionService PredictionService
    logger Logger
}

type ReportGenerator interface {
    GenerateRevenueReport(ctx context.Context, filters *ReportFilters) (*RevenueReport, error)
    GenerateExpenseReport(ctx context.Context, filters *ReportFilters) (*ExpenseReport, error)
    GenerateCustomerReport(ctx context.Context, filters *ReportFilters) (*CustomerReport, error)
}
```

---

## ðŸ—„ï¸ ØªØµÙ…ÙŠÙ… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

### 1. ØªØµÙ…ÙŠÙ… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

#### Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
```sql
-- Users (1) â†â†’ (N) Customers
-- Users (1) â†â†’ (N) Invoices
-- Users (1) â†â†’ (N) Expenses
-- Customers (1) â†â†’ (N) Invoices
-- Invoices (1) â†â†’ (N) Invoice Items
```

#### Ø§Ù„ÙÙ‡Ø§Ø±Ø³ Ø§Ù„Ù…Ø­Ø³Ù†Ø©
```sql
-- User indexes
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_subscription ON users(subscription_plan, subscription_status);
CREATE INDEX idx_users_created_at ON users(created_at);

-- Invoice indexes
CREATE INDEX idx_invoices_user_date ON invoices(user_id, issue_date DESC);
CREATE INDEX idx_invoices_status ON invoices(status);
CREATE INDEX idx_invoices_due_date ON invoices(due_date) WHERE status IN ('sent', 'viewed');
CREATE INDEX idx_invoices_customer ON invoices(customer_id);

-- Customer indexes
CREATE INDEX idx_customers_user ON customers(user_id);
CREATE INDEX idx_customers_name ON customers(name);
CREATE INDEX idx_customers_email ON customers(email);

-- Expense indexes
CREATE INDEX idx_expenses_user_date ON expenses(user_id, expense_date DESC);
CREATE INDEX idx_expenses_category ON expenses(category);
CREATE INDEX idx_expenses_amount ON expenses(amount);
```

### 2. ØªØµÙ…ÙŠÙ… Redis Cache

#### Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
```yaml
Cache Keys:
  - session:{user_id} - User sessions (TTL: 7 days)
  - user:{user_id} - User data (TTL: 1 hour)
  - invoice:{invoice_id} - Invoice data (TTL: 30 minutes)
  - customer:{customer_id} - Customer data (TTL: 1 hour)
  - analytics:{user_id}:{type} - Analytics data (TTL: 15 minutes)
  - rate_limit:{ip}:{endpoint} - Rate limiting (TTL: 1 hour)
```

#### Cache Implementation
```go
type CacheService struct {
    redis *redis.Client
    config CacheConfig
}

type CacheConfig struct {
    DefaultTTL time.Duration
    UserTTL    time.Duration
    InvoiceTTL time.Duration
    AnalyticsTTL time.Duration
}

func (c *CacheService) Get(key string) (interface{}, error) {
    result, err := c.redis.Get(context.Background(), key).Result()
    if err != nil {
        return nil, err
    }
    
    var data interface{}
    err = json.Unmarshal([]byte(result), &data)
    return data, err
}

func (c *CacheService) Set(key string, value interface{}, ttl time.Duration) error {
    data, err := json.Marshal(value)
    if err != nil {
        return err
    }
    
    return c.redis.Set(context.Background(), key, data, ttl).Err()
}
```

---

## ðŸ”’ ØªØµÙ…ÙŠÙ… Ø§Ù„Ø£Ù…Ø§Ù†

### 1. ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„ØªÙÙˆÙŠØ¶

#### JWT Token Structure
```json
{
  "header": {
    "alg": "RS256",
    "typ": "JWT"
  },
  "payload": {
    "sub": "user_id",
    "email": "user@example.com",
    "plan": "premium",
    "permissions": ["invoices:read", "invoices:write", "customers:read"],
    "iat": 1640995200,
    "exp": 1641600000,
    "jti": "token_id"
  }
}
```

#### Permission System
```go
type Permission string

const (
    // Invoice permissions
    PermissionReadInvoices    Permission = "invoices:read"
    PermissionWriteInvoices   Permission = "invoices:write"
    PermissionDeleteInvoices  Permission = "invoices:delete"
    
    // Customer permissions
    PermissionReadCustomers   Permission = "customers:read"
    PermissionWriteCustomers  Permission = "customers:write"
    PermissionDeleteCustomers Permission = "customers:delete"
    
    // Expense permissions
    PermissionReadExpenses    Permission = "expenses:read"
    PermissionWriteExpenses   Permission = "expenses:write"
    PermissionDeleteExpenses  Permission = "expenses:delete"
    
    // Admin permissions
    PermissionAdminAccess     Permission = "admin:access"
    PermissionSystemConfig    Permission = "system:config"
)

type Role struct {
    ID          string       `json:"id"`
    Name        string       `json:"name"`
    Permissions []Permission `json:"permissions"`
}

var Roles = map[string]Role{
    "free": {
        ID:   "free",
        Name: "Free User",
        Permissions: []Permission{
            PermissionReadInvoices,
            PermissionWriteInvoices,
            PermissionReadCustomers,
            PermissionWriteCustomers,
            PermissionReadExpenses,
            PermissionWriteExpenses,
        },
    },
    "premium": {
        ID:   "premium",
        Name: "Premium User",
        Permissions: []Permission{
            PermissionReadInvoices,
            PermissionWriteInvoices,
            PermissionDeleteInvoices,
            PermissionReadCustomers,
            PermissionWriteCustomers,
            PermissionDeleteCustomers,
            PermissionReadExpenses,
            PermissionWriteExpenses,
            PermissionDeleteExpenses,
        },
    },
    "admin": {
        ID:   "admin",
        Name: "Administrator",
        Permissions: []Permission{
            PermissionAdminAccess,
            PermissionSystemConfig,
        },
    },
}
```

### 2. ØªØµÙ…ÙŠÙ… Ø§Ù„ØªØ´ÙÙŠØ±

#### Encryption at Rest
```go
type EncryptionService struct {
    keyManager KeyManager
    cipher     cipher.AEAD
}

type KeyManager interface {
    GetKey(keyID string) ([]byte, error)
    RotateKey(keyID string) error
    CreateKey(keyID string) error
}

func (e *EncryptionService) Encrypt(data []byte, keyID string) ([]byte, error) {
    key, err := e.keyManager.GetKey(keyID)
    if err != nil {
        return nil, err
    }
    
    nonce := make([]byte, 12)
    if _, err := rand.Read(nonce); err != nil {
        return nil, err
    }
    
    ciphertext := e.cipher.Seal(nonce, nonce, data, nil)
    return ciphertext, nil
}

func (e *EncryptionService) Decrypt(data []byte, keyID string) ([]byte, error) {
    key, err := e.keyManager.GetKey(keyID)
    if err != nil {
        return nil, err
    }
    
    nonce := data[:12]
    ciphertext := data[12:]
    
    plaintext, err := e.cipher.Open(nil, nonce, ciphertext, nil)
    if err != nil {
        return nil, err
    }
    
    return plaintext, nil
}
```

#### Encryption in Transit
```go
type TLSService struct {
    config *tls.Config
}

func NewTLSService() *TLSService {
    return &TLSService{
        config: &tls.Config{
            MinVersion: tls.VersionTLS13,
            CipherSuites: []uint16{
                tls.TLS_AES_256_GCM_SHA384,
                tls.TLS_CHACHA20_POLY1305_SHA256,
                tls.TLS_AES_128_GCM_SHA256,
            },
            CurvePreferences: []tls.CurveID{
                tls.X25519,
                tls.CurveP256,
                tls.CurveP384,
            },
        },
    }
}
```

---

## ðŸ“Š ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©

### 1. ØªØµÙ…ÙŠÙ… Ø¬Ù…Ø¹ Ø§Ù„Ù…Ù‚Ø§ÙŠÙŠØ³

#### Application Metrics
```go
type Metrics struct {
    HTTPRequestsTotal    *prometheus.CounterVec
    HTTPRequestDuration  *prometheus.HistogramVec
    ActiveConnections    prometheus.Gauge
    DatabaseConnections  prometheus.Gauge
    CacheHitRate         prometheus.Gauge
    ErrorRate            *prometheus.CounterVec
}

func NewMetrics() *Metrics {
    return &Metrics{
        HTTPRequestsTotal: prometheus.NewCounterVec(
            prometheus.CounterOpts{
                Name: "http_requests_total",
                Help: "Total number of HTTP requests",
            },
            []string{"method", "endpoint", "status"},
        ),
        HTTPRequestDuration: prometheus.NewHistogramVec(
            prometheus.HistogramOpts{
                Name: "http_request_duration_seconds",
                Help: "HTTP request duration in seconds",
                Buckets: prometheus.DefBuckets,
            },
            []string{"method", "endpoint"},
        ),
        ActiveConnections: prometheus.NewGauge(
            prometheus.GaugeOpts{
                Name: "active_connections",
                Help: "Number of active connections",
            },
        ),
        DatabaseConnections: prometheus.NewGauge(
            prometheus.GaugeOpts{
                Name: "database_connections",
                Help: "Number of database connections",
            },
        ),
        CacheHitRate: prometheus.NewGauge(
            prometheus.GaugeOpts{
                Name: "cache_hit_rate",
                Help: "Cache hit rate percentage",
            },
        ),
        ErrorRate: prometheus.NewCounterVec(
            prometheus.CounterOpts{
                Name: "error_rate_total",
                Help: "Total number of errors",
            },
            []string{"service", "error_type"},
        ),
    }
}
```

#### Business Metrics
```go
type BusinessMetrics struct {
    InvoicesCreated      prometheus.Counter
    InvoicesPaid         prometheus.Counter
    OCRScansProcessed    prometheus.Counter
    OCRAccuracy          prometheus.Gauge
    UserRegistrations    prometheus.Counter
    ActiveUsers          prometheus.Gauge
    RevenueGenerated     prometheus.Counter
}

func NewBusinessMetrics() *BusinessMetrics {
    return &BusinessMetrics{
        InvoicesCreated: prometheus.NewCounter(
            prometheus.CounterOpts{
                Name: "invoices_created_total",
                Help: "Total number of invoices created",
            },
        ),
        InvoicesPaid: prometheus.NewCounter(
            prometheus.CounterOpts{
                Name: "invoices_paid_total",
                Help: "Total number of invoices paid",
            },
        ),
        OCRScansProcessed: prometheus.NewCounter(
            prometheus.CounterOpts{
                Name: "ocr_scans_processed_total",
                Help: "Total number of OCR scans processed",
            },
        ),
        OCRAccuracy: prometheus.NewGauge(
            prometheus.GaugeOpts{
                Name: "ocr_accuracy_percentage",
                Help: "OCR accuracy percentage",
            },
        ),
        UserRegistrations: prometheus.NewCounter(
            prometheus.CounterOpts{
                Name: "user_registrations_total",
                Help: "Total number of user registrations",
            },
        ),
        ActiveUsers: prometheus.NewGauge(
            prometheus.GaugeOpts{
                Name: "active_users_total",
                Help: "Total number of active users",
            },
        ),
        RevenueGenerated: prometheus.NewCounter(
            prometheus.CounterOpts{
                Name: "revenue_generated_total",
                Help: "Total revenue generated",
            },
        ),
    }
}
```

### 2. ØªØµÙ…ÙŠÙ… Ø§Ù„Ø³Ø¬Ù„Ø§Øª

#### Structured Logging
```go
type LogEntry struct {
    Timestamp   time.Time              `json:"timestamp"`
    Level       string                 `json:"level"`
    Service     string                 `json:"service"`
    Message     string                 `json:"message"`
    UserID      string                 `json:"user_id,omitempty"`
    RequestID   string                 `json:"request_id,omitempty"`
    Duration    int64                  `json:"duration_ms,omitempty"`
    Fields      map[string]interface{} `json:"fields,omitempty"`
}

type Logger struct {
    logger *logrus.Logger
    config LoggerConfig
}

type LoggerConfig struct {
    Level      string
    Format     string
    Output     string
    Service    string
    Version    string
}

func NewLogger(config LoggerConfig) *Logger {
    logger := logrus.New()
    
    level, err := logrus.ParseLevel(config.Level)
    if err != nil {
        level = logrus.InfoLevel
    }
    logger.SetLevel(level)
    
    if config.Format == "json" {
        logger.SetFormatter(&logrus.JSONFormatter{
            TimestampFormat: time.RFC3339,
        })
    } else {
        logger.SetFormatter(&logrus.TextFormatter{
            TimestampFormat: time.RFC3339,
        })
    }
    
    return &Logger{
        logger: logger,
        config: config,
    }
}

func (l *Logger) Info(ctx context.Context, message string, fields map[string]interface{}) {
    entry := l.logger.WithContext(ctx).WithFields(fields)
    entry.WithField("service", l.config.Service).Info(message)
}

func (l *Logger) Error(ctx context.Context, message string, err error, fields map[string]interface{}) {
    fields["error"] = err.Error()
    entry := l.logger.WithContext(ctx).WithFields(fields)
    entry.WithField("service", l.config.Service).Error(message)
}
```

---

## ðŸš€ ØªØµÙ…ÙŠÙ… Ø§Ù„Ù†Ø´Ø±

### 1. ØªØµÙ…ÙŠÙ… Kubernetes

#### Backend Deployment
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: baseer-backend
  labels:
    app: baseer-backend
spec:
  replicas: 3
  selector:
    matchLabels:
      app: baseer-backend
  template:
    metadata:
      labels:
        app: baseer-backend
    spec:
      containers:
      - name: backend
        image: baseer/backend:latest
        ports:
        - containerPort: 8080
        env:
        - name: DB_HOST
          valueFrom:
            secretKeyRef:
              name: db-secret
              key: host
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: db-secret
              key: password
        - name: REDIS_HOST
          valueFrom:
            secretKeyRef:
              name: redis-secret
              key: host
        - name: REDIS_PASSWORD
          valueFrom:
            secretKeyRef:
              name: redis-secret
              key: password
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 8080
          initialDelaySeconds: 5
          periodSeconds: 5
```

#### Service Configuration
```yaml
apiVersion: v1
kind: Service
metadata:
  name: baseer-backend-service
spec:
  selector:
    app: baseer-backend
  ports:
  - protocol: TCP
    port: 80
    targetPort: 8080
  type: ClusterIP
```

#### Ingress Configuration
```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: baseer-ingress
  annotations:
    kubernetes.io/ingress.class: nginx
    cert-manager.io/cluster-issuer: letsencrypt-prod
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/rate-limit: "100"
spec:
  tls:
  - hosts:
    - api.baseer.app
    secretName: baseer-tls
  rules:
  - host: api.baseer.app
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: baseer-backend-service
            port:
              number: 80
```

### 2. ØªØµÙ…ÙŠÙ… Auto-scaling

#### Horizontal Pod Autoscaler
```yaml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: baseer-backend-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: baseer-backend
  minReplicas: 3
  maxReplicas: 20
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
  - type: Pods
    pods:
      metric:
        name: http_requests_per_second
      target:
        type: AverageValue
        averageValue: "100"
```

#### Vertical Pod Autoscaler
```yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: baseer-backend-vpa
spec:
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: baseer-backend
  updatePolicy:
    updateMode: "Auto"
  resourcePolicy:
    containerPolicies:
    - containerName: backend
      minAllowed:
        cpu: 100m
        memory: 128Mi
      maxAllowed:
        cpu: 1000m
        memory: 1Gi
```

---

## ðŸ“ˆ ØªØµÙ…ÙŠÙ… Ø§Ù„Ø£Ø¯Ø§Ø¡

### 1. ØªØµÙ…ÙŠÙ… ØªØ­Ø³ÙŠÙ† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

#### Query Optimization
```sql
-- Optimized invoice listing query
EXPLAIN (ANALYZE, BUFFERS) 
SELECT 
    i.id,
    i.invoice_number,
    i.total_amount,
    i.status,
    i.issue_date,
    c.name as customer_name
FROM invoices i
JOIN customers c ON i.customer_id = c.id
WHERE i.user_id = $1
  AND i.issue_date >= $2
  AND i.issue_date <= $3
ORDER BY i.issue_date DESC
LIMIT $4 OFFSET $5;

-- Optimized customer search query
EXPLAIN (ANALYZE, BUFFERS)
SELECT 
    id,
    name,
    email,
    phone
FROM customers
WHERE user_id = $1
  AND (
    name ILIKE '%' || $2 || '%'
    OR email ILIKE '%' || $2 || '%'
    OR phone ILIKE '%' || $2 || '%'
  )
ORDER BY name
LIMIT $3;
```

#### Connection Pooling
```go
type DatabaseConfig struct {
    Host            string
    Port            int
    Database        string
    Username        string
    Password        string
    MaxOpenConns    int
    MaxIdleConns    int
    ConnMaxLifetime time.Duration
    ConnMaxIdleTime time.Duration
}

func NewDatabase(config DatabaseConfig) (*sql.DB, error) {
    dsn := fmt.Sprintf("host=%s port=%d dbname=%s user=%s password=%s sslmode=require",
        config.Host, config.Port, config.Database, config.Username, config.Password)
    
    db, err := sql.Open("postgres", dsn)
    if err != nil {
        return nil, err
    }
    
    db.SetMaxOpenConns(config.MaxOpenConns)
    db.SetMaxIdleConns(config.MaxIdleConns)
    db.SetConnMaxLifetime(config.ConnMaxLifetime)
    db.SetConnMaxIdleTime(config.ConnMaxIdleTime)
    
    return db, nil
}
```

### 2. ØªØµÙ…ÙŠÙ… ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª

#### Multi-level Caching
```go
type CacheManager struct {
    l1Cache *cache.Cache
    l2Cache *redis.Client
    config  CacheConfig
}

type CacheConfig struct {
    L1TTL time.Duration
    L2TTL time.Duration
}

func (cm *CacheManager) Get(key string) (interface{}, error) {
    // Try L1 cache first
    if value, found := cm.l1Cache.Get(key); found {
        return value, nil
    }
    
    // Try L2 cache
    value, err := cm.l2Cache.Get(context.Background(), key).Result()
    if err == nil {
        cm.l1Cache.Set(key, value, cm.config.L1TTL)
        return value, nil
    }
    
    return nil, err
}

func (cm *CacheManager) Set(key string, value interface{}) error {
    // Set in both caches
    cm.l1Cache.Set(key, value, cm.config.L1TTL)
    
    data, err := json.Marshal(value)
    if err != nil {
        return err
    }
    
    return cm.l2Cache.Set(context.Background(), key, data, cm.config.L2TTL).Err()
}
```

---

## ðŸ“‹ Ù…Ù„Ø®Øµ Ø§Ù„ØªØµØ§Ù…ÙŠÙ… Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©

### Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
1. **Microservices Architecture**: Ø®Ø¯Ù…Ø§Øª Ù…Ù†ÙØµÙ„Ø© ÙˆÙ‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙˆØ³Ø¹
2. **Clean Architecture**: ÙØµÙ„ ÙˆØ§Ø¶Ø­ Ø¨ÙŠÙ† Ø§Ù„Ø·Ø¨Ù‚Ø§Øª
3. **Event-Driven Design**: Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ù…Ø¯ÙÙˆØ¹Ø© Ø¨Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
4. **Security by Design**: Ø£Ù…Ø§Ù† Ù…Ø¯Ù…Ø¬ ÙÙŠ ÙƒÙ„ Ù…Ø±Ø­Ù„Ø©
5. **Performance Optimization**: Ø£Ø¯Ø§Ø¡ Ù…Ø­Ø³Ù† Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©

### Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
- **Backend**: Go 1.21 + Gin Framework
- **Frontend**: Flutter 3.16.0 + Riverpod
- **Database**: PostgreSQL 15 + Redis 7.2
- **Infrastructure**: AWS + Kubernetes
- **Monitoring**: Prometheus + Grafana
- **Security**: JWT + TLS 1.3 + Encryption

### Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù†Ø¬Ø§Ø­
- **Scalability**: Ø¯Ø¹Ù… 100K+ Ù…Ø³ØªØ®Ø¯Ù… Ù…ØªØ²Ø§Ù…Ù†
- **Performance**: < 100ms API response
- **Security**: Zero security incidents
- **Reliability**: 99.9%+ uptime
- **Maintainability**: Clean code architecture

---

**Ù‡Ø°Ù‡ Ø§Ù„ØªØµØ§Ù…ÙŠÙ… Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ© ØªØ¶Ù…Ù† Ø¨Ù†Ø§Ø¡ Ù†Ø¸Ø§Ù… Ù‚ÙˆÙŠØŒ Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙˆØ³Ø¹ØŒ ÙˆØ¢Ù…Ù† Ù„Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.** ðŸš€
